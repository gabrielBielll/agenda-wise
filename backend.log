SLF4J: No SLF4J providers were found.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See https://www.slf4j.org/codes.html#noProviders for further details.
SUCCESS: JWT_SECRET encontrada. Início: 'chav...', Fim: '...rios'.
MIGRATION: Verificando colunas financeiras na tabela agendamentos...
DATABASE_URL encontrada.
Tentando conectar ao banco de dados...
MIGRATION: Coluna 'valor_repasse' ja existe.
Conexão com o banco de dados estabelecida com sucesso!
MIGRATION: Coluna 'status_repasse' ja existe.
Coluna 'duracao' verificada/adicionada com sucesso.
MIGRATION: Coluna 'status_pagamento' ja existe.
MIGRATION: Verificação concluída.
Coluna 'status' de agendamentos verificada/adicionada com sucesso.
Novas colunas de prontuário verificadas/adicionadas com sucesso.
Coluna 'status' de pacientes verificada/adicionada com sucesso.
Novas colunas de dados clínicos do paciente verificadas/adicionadas com sucesso.
Tabela bloqueios_agenda verificada/criada com sucesso.
Servidor iniciado na porta 3000
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: visualizar_pacientes
DEBUG: Papel ID: #uuid "2a3b8aec-2348-4eb1-847a-a82516cfe6b6"
DEBUG: Listar Agendamentos - User: #uuid "ddf89084-1524-4748-93fd-dad6df68e399" Papel: psicologo Clinica: #uuid "967b3f16-04c2-489c-90d4-306bd967844e" Paciente Filter: nil
DEBUG: Permissao encontrada? {:permissao_id #uuid "ab77488b-5680-40a6-9614-917dd6e0ba35"}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Listar Agendamentos - User: #uuid "912e8b25-845d-45d0-bcd9-a6a300d78aff" Papel: admin_clinica Clinica: #uuid "967b3f16-04c2-489c-90d4-306bd967844e" Paciente Filter: nil
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status cancelado}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente?DEBUG: Middleware JWT. Token presente?  true
true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente?DEBUG: Middleware Permissao. Requer:  visualizar_pacientestrue

DEBUG: Papel ID: #uuid "2a3b8aec-2348-4eb1-847a-a82516cfe6b6"
DEBUG: Listar Agendamentos - User: #uuid "ddf89084-1524-4748-93fd-dad6df68e399" Papel: psicologo Clinica: #uuid "967b3f16-04c2-489c-90d4-306bd967844e" Paciente Filter: nil
DEBUG: Permissao encontrada? {:permissao_id #uuid "ab77488b-5680-40a6-9614-917dd6e0ba35"}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Listar Agendamentos - User: #uuid "912e8b25-845d-45d0-bcd9-a6a300d78aff" Papel: admin_clinica Clinica: #uuid "967b3f16-04c2-489c-90d4-306bd967844e" Paciente Filter: nil
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:valor_consulta 0}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status_pagamento pago}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status_repasse disponivel, :valor_repasse 0}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status_repasse transferido, :valor_repasse 0}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status_pagamento pago}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status_pagamento pendente}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status_pagamento pago}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status_pagamento pendente}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Listar Agendamentos - User: #uuid "912e8b25-845d-45d0-bcd9-a6a300d78aff" Papel: admin_clinica Clinica: #uuid "967b3f16-04c2-489c-90d4-306bd967844e" Paciente Filter: nil
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status_pagamento pago}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status cancelado}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status realizado}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status_pagamento pago}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status_pagamento pendente}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status_pagamento pago}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status_pagamento pendente}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status_repasse transferido, :valor_repasse 0}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status_pagamento pago}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status_pagamento pago}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Listar Agendamentos - User: #uuid "912e8b25-845d-45d0-bcd9-a6a300d78aff" Papel: admin_clinica Clinica: #uuid "967b3f16-04c2-489c-90d4-306bd967844e" Paciente Filter: nil
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status_pagamento pendente}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:status_pagamento pago}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "1f512630-1e2f-43b0-97fb-5df3dfffc8fe"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:valor_consulta 80}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: visualizar_pacientes
DEBUG: Papel ID: #uuid "2a3b8aec-2348-4eb1-847a-a82516cfe6b6"
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Listar Agendamentos - User: #uuid "ddf89084-1524-4748-93fd-dad6df68e399" Papel: psicologo Clinica: #uuid "967b3f16-04c2-489c-90d4-306bd967844e" Paciente Filter: nil
DEBUG: Permissao encontrada? {:permissao_id #uuid "ab77488b-5680-40a6-9614-917dd6e0ba35"}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: visualizar_pacientes
DEBUG: Papel ID: #uuid "2a3b8aec-2348-4eb1-847a-a82516cfe6b6"
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Listar Agendamentos - User: #uuid "ddf89084-1524-4748-93fd-dad6df68e399" Papel: psicologo Clinica: #uuid "967b3f16-04c2-489c-90d4-306bd967844e" Paciente Filter: nil
DEBUG: Permissao encontrada? {:permissao_id #uuid "ab77488b-5680-40a6-9614-917dd6e0ba35"}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: gerenciar_agendamentos_clinica
DEBUG: Papel ID: #uuid "2a3b8aec-2348-4eb1-847a-a82516cfe6b6"
DEBUG: Permissao encontrada? {:permissao_id #uuid "fc95b709-4764-4ab5-8939-3e0009093941"}
DEBUG: Atualizando agendamento. Body: {:paciente_id 101b3d51-6945-4ff7-8b40-06f949ac3b3a, :force false, :psicologo_id ddf89084-1524-4748-93fd-dad6df68e399, :duracao 50, :mode nil, :data_hora_sessao 2026-01-28 11:00:00, :valor_consulta 100, :observacoes , :quantidade_recorrencia 1}
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware Permissao. Requer: visualizar_pacientes
DEBUG: Papel ID: #uuid "2a3b8aec-2348-4eb1-847a-a82516cfe6b6"
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Permissao encontrada? {:permissao_id #uuid "ab77488b-5680-40a6-9614-917dd6e0ba35"}
DEBUG: Listar Agendamentos - User: #uuid "ddf89084-1524-4748-93fd-dad6df68e399" Papel: psicologo Clinica: #uuid "967b3f16-04c2-489c-90d4-306bd967844e" Paciente Filter: nil
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Listar Agendamentos - User: #uuid "912e8b25-845d-45d0-bcd9-a6a300d78aff" Papel: admin_clinica Clinica: #uuid "967b3f16-04c2-489c-90d4-306bd967844e" Paciente Filter: nil
DEBUG: Middleware JWT. Token presente? true
DEBUG: Middleware JWT. Token presente? true
DEBUG: Listar Agendamentos - User: #uuid "912e8b25-845d-45d0-bcd9-a6a300d78aff" Papel: admin_clinica Clinica: #uuid "967b3f16-04c2-489c-90d4-306bd967844e" Paciente Filter: nil
